# The file defines types of tests to be skipped by the --skip-testtypes option
# of the containers/runner/launch script.
# The file is sourced from shell scripts.

# test types skipped in all scenarios
common_skip_array=(
  knownfailure
  manual
)

fedora_skip_array=(
  skip-on-fedora
)

fedora_disabled_array=(
  gh576       # clearpart-4 test is flaky on all scenarios
  gh595       # proxy-cmdline failing on all scenarios
  gh641       # packages-multilib failing on systemd conflict
  gh777       # raid-1-reqpart failing
  gh890       # default-systemd-target-vnc-graphical-provides flaking too much
  rhbz1853668 # multipath device not constructed back after installation
  gh975       # packages-default failing
  gh1023      # rpm-ostree failing
  gh1335      # image-deployment-2 failing
  gh1437      # lvm-cache-* failing
  gh1493      # dns-global-exclusive-tls-* failing
  gh1530      # dns-global-exclusive-tls-* stage2-from-compose failing
  gh1514      # groups-and-envs-2 failing
)

daily_iso_disabled_array=(
  gh1434      # reboot-inital-setup-* failing
  gh910       # stage2-from-ks test needs to be fixed for daily-iso
)

rawhide_disabled_array=(
)

rawhide_text_disabled_array=(
  rhbz1853668 # multipath device not constructed back after installation
)

rhel8_skip_array=(
  skip-on-rhel
  skip-on-rhel-8
)

rhel8_disabled_array=(
  gh576       # clearpart-4 test is flaky on all scenarios
  gh595       # proxy-cmdline failing on all scenarios
  gh1018      # bridge-no-bootopts-net failing
  gh804       # tests requiring dvd iso failing
)

rhel9_skip_array=(
  skip-on-rhel
  skip-on-rhel-9
)

rhel9_disabled_array=(
  gh576       # clearpart-4 test is flaky on all scenarios
  gh595       # proxy-cmdline failing on all scenarios
  gh604       # packages-weakdeps: "gnupg2 --recommends has changed, test needs to be updated"
  gh641       # packages-multilib failing on systemd conflict
  gh804       # tests requiring dvd iso failing
  rhel16355   # mountpoint-assigment-plain waiting for feature release
)

rhel10_centos10_disabled_array=(
  gh576       # clearpart-4 test is flaky on all scenarios
  gh804       # tests requiring dvd iso failing
  gh1090      # raid-1-reqpart failing
  gh1207      # packages-multilib failing
  gh1213      # harddrive-iso-single failing
)

rhel10_skip_array=(
  skip-on-rhel
  skip-on-rhel-10
)

centos10_skip_array=(
  skip-on-centos
  skip-on-centos-10
)

centos10_disabled_array=(
  gh1466      # ftp source tests failing
  gh1474      # proxy-cmdline failing
)

fedora_eln_skip_array=(
  skip-on-fedora-eln
)

fedora_eln_disabled_array=(
  gh1213      # harddrive-iso-single failing
  gh1090      # raid-1-reqpart failing
  gh1527      # rootpw-basic and rootpw-lock failing
  gh1207      # packages-multilib failing
  gh975       # packages-default failing
  gh1530      # dns-global-exclusive-tls-* stage2-from-compose failing
)

# used in workflows/daily-boot-iso-rhel8.yml
rhel8_daily_skip_array=(
  skip-on-rhel
  skip-on-rhel-8
)

anaconda_pr_skip_array=(
  stage2-from-compose
)

_join_args_by_comma(){
  local IFS=","
  echo "$*"
}

# Do not forget to add new releases below as well
SKIPPED_TESTTYPES_RAWHIDE=$(_join_args_by_comma "${common_skip_array[@]}" "${fedora_skip_array[@]}")
SKIPPED_TESTTYPES_RAWHIDE_TEXT=$(_join_args_by_comma "${common_skip_array[@]}" "${fedora_skip_array[@]}")
SKIPPED_TESTTYPES_DAILY_ISO=$(_join_args_by_comma "${common_skip_array[@]}" "${fedora_skip_array[@]}")
SKIPPED_TESTTYPES_RHEL8=$(_join_args_by_comma "${common_skip_array[@]}" "${rhel8_skip_array[@]}")
SKIPPED_TESTTYPES_RHEL9=$(_join_args_by_comma "${common_skip_array[@]}" "${rhel9_skip_array[@]}")
SKIPPED_TESTTYPES_RHEL10=$(_join_args_by_comma "${common_skip_array[@]}" "${rhel10_skip_array[@]}")
SKIPPED_TESTTYPES_CENTOS10=$(_join_args_by_comma "${common_skip_array[@]}" "${centos10_skip_array[@]}")
SKIPPED_TESTTYPES_RHEL8_DAILY=$(_join_args_by_comma "${common_skip_array[@]}" "${rhel8_daily_skip_array[@]}")
SKIPPED_TESTTYPES_FEDORA_ELN=$(_join_args_by_comma "${common_skip_array[@]}" "${fedora_eln_skip_array[@]}")

# Tests run on an anaconda pull request by comment
SKIPPED_TESTTYPES_ANACONDA_PR=$(_join_args_by_comma "${common_skip_array[@]}" "${anaconda_pr_skip_array[@]}")

DISABLED_TESTTYPES_DAILY_ISO=$(_join_args_by_comma "${fedora_disabled_array[@]}" "${daily_iso_disabled_array[@]}")
DISABLED_TESTTYPES_RAWHIDE=$(_join_args_by_comma "${fedora_disabled_array[@]}" "${rawhide_disabled_array[@]}")
DISABLED_TESTTYPES_RHEL8=$(_join_args_by_comma "${rhel8_disabled_array[@]}")
DISABLED_TESTTYPES_RHEL9=$(_join_args_by_comma "${rhel9_disabled_array[@]}")
DISABLED_TESTTYPES_RHEL10=$(_join_args_by_comma "${rhel10_centos10_disabled_array[@]}")
DISABLED_TESTTYPES_CENTOS10=$(_join_args_by_comma "${rhel10_centos10_disabled_array[@]}" "${centos10_disabled_array[@]}")
DISABLED_TESTTYPES_FEDORA_ELN=$(_join_args_by_comma "${common_skip_array[@]}" "${fedora_eln_disabled_array[@]}")

# Keeping for scripts/run-ci.sh
SKIP_TESTTYPES_RAWHIDE="${SKIPPED_TESTTYPES_RAWHIDE},${DISABLED_TESTTYPES_RAWHIDE}"
